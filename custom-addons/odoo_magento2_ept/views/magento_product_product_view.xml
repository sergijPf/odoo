<?xml version="1.0" encoding="utf-8"?>
<odoo>
        <record id="act_magento_product" model="ir.actions.act_window">
            <field name="name">Magento Product</field>
            <field name="res_model">magento.product.product</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('odoo_product_id','=',active_id)]</field>
            <field name="context">{'search_default_product_id': active_id}</field>
        </record>

        <record id="product_product_magento_button" model="ir.ui.view">
            <field name="name">product.product.magento.button</field>
            <field name="model">product.product</field>
            <field name="inherit_id" ref="product.product_normal_form_view"/>
            <field name="arch" type="xml">
                <div name="button_box" position="inside">
                    <button class="oe_stat_button" name="%(odoo_magento2_ept.act_magento_product)d" type="action"
                            icon="fa-external-link" help="Magento Products">
                        <field string="Magento Products" name="magento_product_count" widget="statinfo"/>
                    </button>
                </div>
            </field>
        </record>
        <record id="view_magento_product_form" model="ir.ui.view">
            <field name="name">magento.product.product.form</field>
            <field name="model">magento.product.product</field>
            <field name="arch" type="xml">
                <form string="Product" name="product_form" create="false">
                    <header>
                        <button name="process_manually"
                                string="Process Export Manually"
                                type="object" class="btn-primary"
                                attrs="{'invisible':[('magento_status', '=', 'in_magento')]}"/>
                    </header>
                    <sheet>
                        <field name="id" invisible="True" modifiers="{'invisible': true, 'readonly': true}"/>
                        <field name="active" invisible="True" />
                        <field name="active_product" class="oe_inline" invisible='1'/>
                        <div class="oe_button_box" name="button_box">
                            <button class="oe_stat_button"
                                    name="toggle_active" icon="fa-lock"
                                    type="object" attrs="{'invisible': [('active','=',False)]}">
                                <span class="o_stat_text" style="color:#2dab2d">Active</span>
                            </button>
                            <button class="oe_stat_button"
                                    name="toggle_active" icon="fa-unlock"
                                    type="object" attrs="{'invisible': [('active','=',True)]}">
                                <span class="o_stat_text" style="color:#da3434">Archived</span>
                            </button>
                            <button class="oe_stat_button" name="delete_in_magento" icon="fa-remove" type="object"
                                    attrs="{'invisible': [('magento_product_id','in',['', False, None])]}"
                                    modifiers="{}" options="{}">
                                <span class="o_stat_text" style="color:#da3434" modifiers="{}">
                                    Delete in Magento
                                </span>
                            </button>
                            <button string="Odoo Product" type="object" name="view_odoo_product"  class="oe_stat_button" icon="fa-chain" />
                        </div>
                        <widget name="web_ribbon" text="In Magento" attrs="{'invisible': [('magento_status', '!=', 'in_magento')]}"/>
                        <widget name="web_ribbon" title="Deleted" bg_color="bg-danger" attrs="{'invisible': [('magento_status', '!=', 'deleted')]}"/>
                        <field name="image_1920" widget="image" class="oe_avatar" />
                        <div class="oe_title">
                            <label class="oe_edit_only" for="magento_product_name"/>
                            <h1>
                                <field name="magento_product_name" placeholder="Product Name" modifiers="{'required': true}" readonly="1"/>
                            </h1>
                            <h3>
                                <field name="x_magento_name" placeholder="Name for Magento" modifiers="{}" id="x_magento_name"/>
                            </h3>
                            <field name="product_template_attribute_value_ids"
                                   widget="many2many_tags"
                                   attrs="{'invisible': [('product_type', '=', 'configurable')]}"
                                   readonly="1"
                                   modifiers="{}"/>
                        </div>
                        <notebook>
                            <page string="General Information" name="general_information">
<!--                                <group>-->
                                    <group name="group_general" string="General">
                                        <field name="magento_tmpl_id" readonly="1"/>
                                        <field name="odoo_product_id" readonly="1"/>
                                        <br/>
                                        <field name="odoo_prod_categ"/>
                                        <field name="magento_prod_categ"/>
                                        <field name="prod_categ_name"/>
                                        <br/>
                                        <field name="magento_sku" readonly="1"/>
<!--                                        <field name="x_magento_name" readonly="1"/>-->
                                        <!--                                            <field name="magento_product_id" readonly="1"/>-->
                                    </group>
                                    <group name="group_standard_price" string="Pricing">
                                        <field name="total_magento_variants" invisible="1"/>
                                        <field name="lst_price" readonly="1" widget="monetary" options="{'currency_field': 'currency_id'}" attrs="{'readonly': [('total_magento_variants', '&gt;', 1)]}" modifiers="{'readonly': [['total_magento_variants', '&gt;', 1]]}"/>
                                        <field name="valuation" invisible="1" readonly="1" modifiers="{'invisible': true, 'readonly': true}"/>
                                        <field name="cost_method" invisible="1" readonly="1" modifiers="{'invisible': true, 'readonly': true}"/>
                                        <label for="standard_price"/>
                                        <div name="standard_price_uom">
                                            <field name="standard_price" readonly="1" attrs="{'readonly':['&amp;', ('valuation','=','real_time'), ('cost_method', 'in', ['standard', 'average'])]}" class="oe_inline" widget="monetary" options="{'currency_field': 'currency_id'}" modifiers="{'readonly': ['&amp;', ['valuation', '=', 'real_time'], ['cost_method', 'in', ['standard', 'average']]]}"/>
                                        </div>
                                        <button string="Set standard price" type="action" name="311" class="oe_link oe_read_only" colspan="2" invisible="1" modifiers="{'invisible': true}"/>
                                        <button string="Set standard price" type="action" name="311" class="oe_link oe_read_only" colspan="2" invisible="1" modifiers="{'invisible': true}"/>
                                        <field name="company_id" options="{'no_create': True}" can_create="true" can_write="true" invisible="1" modifiers="{'invisible': true}"/>
                                        <field name="uom_id" options="{'no_create': True}" on_change="1" can_create="true" can_write="true" invisible="1" modifiers="{'invisible': true, 'required': true}"/>
                                        <field name="uom_po_id" options="{'no_create': True}" on_change="1" can_create="true" can_write="true" invisible="1" modifiers="{'invisible': true, 'required': true}"/>
                                        <field name="currency_id" invisible="1" can_create="true" can_write="true" modifiers="{'invisible': true, 'readonly': true}"/>
                                    </group>
<!--                                </group>-->
                            </page>
<!--                                <page string="Notes" name="notes">-->
<!--                                    <group name="description">-->
<!--                                        <separator string="Description" colspan="4"/>-->
<!--                                        <field name="description" colspan="4" nolabel="1" placeholder="This note will be displayed on the quotations." modifiers="{}"/>-->
<!--                                        <separator string="Short Description" colspan="4"/>-->
<!--                                        <field name="short_description" colspan="4" nolabel="1" placeholder="This note will be displayed on the quotations." modifiers="{}"/>-->
<!--                                    </group>-->
<!--                                </page>-->
                            <page string="Magento Details" name="magento_conf">
                                <group>
                                    <field name="magento_instance_id" readonly="1"/>
                                    <field name="magento_product_id" readonly="1"/>
                                    <field name="magento_website_ids" widget="many2many_tags" readonly="1"/>
                                    <field name="magento_status" readonly="1"/>
<!--                                        <field name="magento_product_id" readonly="1" invisible="1"/>-->
<!--                                        <field name="created_at" readonly="1"/>-->
                                    <field name="magento_export_date" readonly="1"/>
<!--                                        <field name="updated_at" readonly="1"/>-->
                                    <field name="magento_export_date_conf" readonly="1"/>
                                    <field name="product_type" invisible="1"/>
                                    <!--<field name="magento_website_ids" widget="many2many_tags" options="{'no_create_edit': True}" readonly="1"/>-->
                                </group>
                            </page>

<!--                                <page string="Images" name="images">-->
<!--                                    <group string="Images Info" colspan="4">-->
<!--                                        <field name="magento_product_image_ids"-->
<!--                                            context="{'default_name': magento_product_name,'default_magento_product_id':id}"-->
<!--                                            mode="kanban" nolabel="1">-->
<!--                                        </field>-->
<!--                                    </group>-->
<!--                                </page>-->
                        </notebook>
                    </sheet>
                </form>
            </field>
        </record>
        <record id="view_magento_product_tree" model="ir.ui.view">
            <field name="name">magento.product.product.tree</field>
            <field name="model">magento.product.product</field>
            <field name="arch" type="xml">
                <tree string="Magento Product" create="false" default_order="magento_instance_id,magento_sku">
                    <header>
                        <button name="process_products_export_to_magento"
                                context="{'status_check': True}"
                                string="Update Export Status"
                                type="object"
                                class="btn btn-info ml-3"/>
                    </header>
                    <field name="magento_product_id" string="Magento Product ID" invisible="1"/>
                    <field name="magento_instance_id"/>
                    <field name="magento_product_id"/>
                    <field name="magento_website_ids" widget="many2many_tags"/>
                    <field name="magento_sku"/>
                    <field name="magento_product_name"/>
                    <field name="product_template_attribute_value_ids" widget="many2many_tags" readonly="1"
                           optional="show" can_create="false" can_write="false" modifiers="{'readonly':true}"/>
                    <field name="qty_available"/>
                    <!--                        <field name="product_type"/>-->
                    <field name="magento_status" widget="badge" optional="show" on_change="1"
                           decoration-success="magento_status == 'in_magento'"
                           decoration-muted="magento_status == 'not_exported' or magento_status == 'deleted'"
                           decoration-info="magento_status == 'in_process'"
                           decoration-warning="magento_status == 'need_to_link' or magento_status == 'update_needed'"
                           decoration-danger="magento_status == 'log_error'"
                           modifiers="{'readonly':true}"
                    />
                    <!--                        <field name="sync_product_with_magento"/>-->
                </tree>
            </field>
        </record>

    <record id="magento_product_normal_action_sell_ept" model="ir.actions.act_window">
        <field name="name">Product Variants</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">magento.product.product</field>
        <field name="view_mode">form,tree</field>
        <field name="view_id" ref="view_magento_product_tree"/>
        <field name="help" type="html">
            <p>
                You can't create Product Variants directly from Here.
            </p>
            <br/>
            <p>
                <b>1. Import Products from Magento</b>
                <br/>
                Go to
                <i>Magento
                    <i class="fa fa-angle-double-right"/>
                    Operation
                    <i class="fa fa-angle-double-right"/>
                    All Operation
                </i>
                <br/>
                Select 'Import Products' and click on Execute.
            </p>
            <p>
                <b>2. Automatic Import Products from Magento to Odoo</b>
                <br/>
                Go to
                <i>Magento
                    <i class="fa fa-angle-double-right"/>
                    Configuration
                    <i class="fa fa-angle-double-right"/>
                    Instances
                </i>
                <br/>
                click on Magento Schedulers and Activate "Import Product" cron job.
            </p>
        </field>
    </record>

    <record id="magento_product_product_search_view" model="ir.ui.view">
        <field name="name">magento.product.product.search.view</field>
        <field name="model">magento.product.product</field>
        <field name="arch" type="xml">
            <search string="Magento product search view">
                <field name="prod_categ_name"/>
                <field name="magento_product_id" />
                <field name="magento_sku" />
                <field name="magento_product_name" />
                <!--                    <field name="magento_instance_id"/>-->
                <filter string="Not in Magento" name="not_in_magento"
                        domain="[('magento_status', '!=', 'in_magento')]"/>
                <separator/>
                <filter name="archived" string="Archived" domain="[('active','=',0)]"/>
                <group expand="1" string="Group By">
                    <filter string="Instances" name="group_by_instance"
                            context="{'group_by': 'magento_instance_id'}"/>
                    <filter string="Product Category" name="group_by_product_category"
                            context="{'group_by': 'prod_categ_name'}"/>
                    <filter string="Magento Status" name="group_by_status"
                            context="{'group_by': 'magento_status'}"/>
                </group>
<!--                    <filter name="archive" string="Archived" domain="[('active','=',False)]"/>-->
            </search>
        </field>
    </record>

    <record id="action_magento_product_export_prepare" model="ir.actions.server">
        <field name="name">Export To Magento</field>
        <field name="model_id" ref="model_magento_product_product"/>
        <field name="binding_model_id" ref="model_magento_product_product"/>
        <field name="binding_view_types">list,form</field>
        <field name="state">code</field>
        <field name="code">records.process_products_export_to_magento()</field>
    </record>

    <menuitem id="menu_magento_proucts_parent" name="Catalog" parent="odoo_magento2_ept.menu_magento_root" sequence="3"/>

    <menuitem id="menu_item_magento_product_variants_ept" name="Product variants"
        parent="odoo_magento2_ept.menu_magento_proucts_parent" sequence="3"
        action="magento_product_normal_action_sell_ept"/>
</odoo>
